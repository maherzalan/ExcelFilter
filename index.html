<!DOCTYPE html>
<html lang="ar">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>فلترة Excel</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <style>
    body {
      background-color: #f8f9fa;
      /* لون خلفية الصفحة */
    }

    h1 {
      color: #343a40;
      /* لون العنوان */
    }

    .modal-header {
      background-color: #007bff;
      /* لون رأس النافذة المنبثقة */
      color: white;
      /* لون النص في الرأس */
    }

    .btn-primary {
      background-color: #007bff;
      /* لون زر اختيار معايير الفلترة */
    }

    .btn-success {
      background-color: #28a745;
      /* لون زر فلترة البيانات */
    }

    .btn-info {
      background-color: #17a2b8;
      /* لون زر تنزيل البيانات */
    }

    .thead-dark {
      background-color: #343a40;
      /* لون خلفية الرأس في الجدول */
      color: white;
      /* لون النص في الرأس */
    }

    .table-bordered td,
    .table-bordered th {
      background: #fff;
    }

    #loadingMessage {
      display: none;
      font-weight: bold;
      color: blue;
      margin-top: 10px;
    }
  </style>
  </style>
</head>

<body>

  <div class="container text-center">
    <h1 class="mt-5">تحميل وفلترة ملف Excel</h1>

    <input type="file" id="fileInput" class="form-control my-3" />
    <button id="openFilterBtn" class="btn btn-primary mb-3">اختيار معايير الفلترة</button>

    <div id="loadingMessage">Loading... الرجاء الانتظار أثناء تحميل الملف</div>

    <div id="filterModal" class="modal">
      <div class="modal-dialog modal-lg">
        <div class="modal-content  text-left">
          <div class="modal-header">
            <h5 class="modal-title">اختر معايير الفلترة</h5>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          <div class="modal-body">
            <form id="filterForm">
              <div class="form-check">
                <input type="checkbox" class="form-check-input" name="criteria"
                  value="Unaccompanied child head of household" id="criteria1">
                <label class="form-check-label" for="criteria1">Unaccompanied child head of household</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" name="criteria" value="Separated child" id="criteria2">
                <label class="form-check-label" for="criteria2">Separated child</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" name="criteria" value="Serious medical/health condition"
                  id="criteria3">
                <label class="form-check-label" for="criteria3">Serious medical/health condition</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" name="criteria" value="Pregnant woman" id="criteria4">
                <label class="form-check-label" for="criteria4">Pregnant woman</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" name="criteria"
                  value="Person with disability – visual impairment" id="criteria5">
                <label class="form-check-label" for="criteria5">Person with disability – visual impairment</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" name="criteria"
                  value="Person with disability – physical disability" id="criteria6">
                <label class="form-check-label" for="criteria6">Person with disability – physical disability</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" name="criteria"
                  value="Person with disability – intellectual disability" id="criteria7">
                <label class="form-check-label" for="criteria7">Person with disability – intellectual disability</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" name="criteria"
                  value="Person with disability – hearing impairment" id="criteria8">
                <label class="form-check-label" for="criteria8">Person with disability – hearing impairment</label>
              </div>
              <button type="submit" class="btn btn-success mt-3">فلترة البيانات</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <input type="text" id="searchInput" placeholder="ابحث في الجدول..." class="form-control my-3">
    <h3>مجموع النتائج: <span id="resultCount">0</span></h3>
    <button id="downloadBtn" class="btn btn-info" style="display: none;">تنزيل البيانات المفلترة كـ Excel</button>

    <table id="resultTable" class="table table-bordered mt-3">
      <thead class="thead-dark">
        <tr>
          <th data-column="HOF ID">HOF ID</th>
          <th data-column="HOF FullName">HOF FullName</th>
          <th data-column="Member FullName">Member FullName</th>
          <th data-column="Member ID">Member ID</th>
          <th data-column="Member Date Birth">Member Date Birth</th>
          <th data-column="Member Gender">Member Gender</th>
          <th data-column="Relation Type">Relation Type</th>
          <th data-column="Center Name">Center Name</th>
          <th data-column="Vulnerability">Vulnerability</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
    <footer>
      <div class="mb-0" style="text-align:center">
        Powerd By: Mr.Maher Zalan
      </div>
      <div class="mb-0" style="text-align:center">
        Jawwal No: 0599535638
      </div>
    </footer>
  </div>

  <script>
    function _0x5a8c(_0x3f5e77,_0x417dc7){const _0x4f4249=_0x4f42();return _0x5a8c=function(_0x5a8c4d,_0x3421e0){_0x5a8c4d=_0x5a8c4d-0x1ea;let _0x429ecb=_0x4f4249[_0x5a8c4d];return _0x429ecb;},_0x5a8c(_0x3f5e77,_0x417dc7);}const _0x5aca49=_0x5a8c;(function(_0x2f3954,_0x3f9928){const _0xfb41ff=_0x5a8c,_0x7777d6=_0x2f3954();while(!![]){try{const _0x29902d=-parseInt(_0xfb41ff(0x218))/0x1*(-parseInt(_0xfb41ff(0x1f5))/0x2)+-parseInt(_0xfb41ff(0x1ee))/0x3*(parseInt(_0xfb41ff(0x21f))/0x4)+-parseInt(_0xfb41ff(0x1f7))/0x5*(parseInt(_0xfb41ff(0x226))/0x6)+-parseInt(_0xfb41ff(0x202))/0x7+parseInt(_0xfb41ff(0x1f8))/0x8+-parseInt(_0xfb41ff(0x228))/0x9+parseInt(_0xfb41ff(0x22e))/0xa;if(_0x29902d===_0x3f9928)break;else _0x7777d6['push'](_0x7777d6['shift']());}catch(_0x192495){_0x7777d6['push'](_0x7777d6['shift']());}}}(_0x4f42,0xdc69e),$(document)[_0x5aca49(0x215)](function(){const _0x55a3b4=_0x5aca49;let _0xf845f7=[],_0x3eed4a=[],_0x892b4f=_0x55a3b4(0x22f);$(_0x55a3b4(0x1fc))['on'](_0x55a3b4(0x222),function(_0xeadab3){const _0x3a3ade=_0x55a3b4,_0x104588=_0xeadab3['target'][_0x3a3ade(0x21d)][0x0],_0x299625=new FileReader();$(_0x3a3ade(0x232))[_0x3a3ade(0x217)](),_0x299625['onload']=function(_0x47b33e){const _0x3ca8c0=_0x3a3ade,_0x22ee61=new Uint8Array(_0x47b33e[_0x3ca8c0(0x21b)][_0x3ca8c0(0x225)]),_0x595a2c=XLSX[_0x3ca8c0(0x21e)](_0x22ee61,{'type':'array'}),_0x258f92=_0x595a2c['Sheets'][_0x595a2c['SheetNames'][0x0]];_0xf845f7=XLSX[_0x3ca8c0(0x205)][_0x3ca8c0(0x210)](_0x258f92),$(_0x3ca8c0(0x232))[_0x3ca8c0(0x22a)]();},_0x299625[_0x3a3ade(0x216)](_0x104588);}),$(_0x55a3b4(0x20c))['on'](_0x55a3b4(0x206),function(){const _0x474a28=_0x55a3b4;$('#filterModal')['modal'](_0x474a28(0x217));}),$(_0x55a3b4(0x213))['on'](_0x55a3b4(0x20a),function(_0x3e9d55){const _0x28b093=_0x55a3b4;_0x3e9d55['preventDefault']();const _0x2cf170=[];$('input[name=\x27criteria\x27]:checked')['each'](function(){const _0x53b917=_0x5a8c;_0x2cf170[_0x53b917(0x207)]($(this)[_0x53b917(0x1fb)]());});if(_0x2cf170[_0x28b093(0x220)]===0x0){alert(_0x28b093(0x200));return;}_0x3eed4a=_0xf845f7[_0x28b093(0x219)](_0x2ed0a9=>{const _0x335626=_0x28b093,_0x33788e=_0x2ed0a9[_0x335626(0x224)]?_0x2ed0a9[_0x335626(0x224)]['split'](','):[];return _0x33788e[_0x335626(0x229)](_0x2b5e03=>_0x2cf170[_0x335626(0x1ff)](_0x2b5e03[_0x335626(0x203)]()));}),$(_0x28b093(0x22c))[_0x28b093(0x204)](_0x3eed4a[_0x28b093(0x220)]),$(_0x28b093(0x20d))['toggle'](_0x3eed4a[_0x28b093(0x220)]>0x0),_0x26d0f9(_0x3eed4a),$(_0x28b093(0x1f0))['modal'](_0x28b093(0x22a));});function _0x26d0f9(_0x2e1bb8){const _0x544210=_0x55a3b4;$('#resultTable\x20tbody')[_0x544210(0x208)](),_0x2e1bb8[_0x544210(0x20f)](_0x2d3e81=>{const _0x3de50d=_0x544210,_0x20eaa1=_0x2d3e81['Member\x20Date\x20Birth'],_0x157b11=_0x20eaa1?XLSX[_0x3de50d(0x1eb)][_0x3de50d(0x230)](_0x20eaa1):null,_0x46125e=_0x157b11?_0x157b11['y']+'-'+String(_0x157b11['m'])['padStart'](0x2,'0')+'-'+String(_0x157b11['d'])[_0x3de50d(0x22d)](0x2,'0'):'';$(_0x3de50d(0x231))[_0x3de50d(0x20e)](_0x3de50d(0x1fa)+(_0x2d3e81['HOF\x20ID']||'')+_0x3de50d(0x214)+(_0x2d3e81[_0x3de50d(0x1fe)]||'')+_0x3de50d(0x214)+(_0x2d3e81['Member\x20FullName']||'')+_0x3de50d(0x214)+(_0x2d3e81[_0x3de50d(0x20b)]||'')+_0x3de50d(0x214)+(_0x46125e||'')+_0x3de50d(0x214)+(_0x2d3e81[_0x3de50d(0x221)]||'')+_0x3de50d(0x214)+(_0x2d3e81[_0x3de50d(0x22b)]||'')+_0x3de50d(0x214)+(_0x2d3e81[_0x3de50d(0x1f4)]||'')+_0x3de50d(0x214)+(_0x2d3e81[_0x3de50d(0x224)]||'')+_0x3de50d(0x209));});}$('th')['on'](_0x55a3b4(0x206),function(){const _0x3c1244=_0x55a3b4,_0x1b5278=$(this)['data'](_0x3c1244(0x1f1));_0x892b4f=_0x892b4f===_0x3c1244(0x22f)?'desc':_0x3c1244(0x22f),_0x3eed4a[_0x3c1244(0x21c)]((_0x8c193,_0x153871)=>{const _0x5c18da=_0x3c1244;let _0x2d1cca=_0x8c193[_0x1b5278]||'',_0x116a0e=_0x153871[_0x1b5278]||'';if(_0x1b5278==='Member\x20Date\x20Birth')return _0x2d1cca=_0x2d1cca?XLSX[_0x5c18da(0x1eb)]['parse_date_code'](_0x2d1cca):{'y':0x76c,'m':0x1,'d':0x1},_0x116a0e=_0x116a0e?XLSX[_0x5c18da(0x1eb)]['parse_date_code'](_0x116a0e):{'y':0x76c,'m':0x1,'d':0x1},_0x892b4f===_0x5c18da(0x22f)?new Date(_0x2d1cca['y'],_0x2d1cca['m']-0x1,_0x2d1cca['d'])-new Date(_0x116a0e['y'],_0x116a0e['m']-0x1,_0x116a0e['d']):new Date(_0x116a0e['y'],_0x116a0e['m']-0x1,_0x116a0e['d'])-new Date(_0x2d1cca['y'],_0x2d1cca['m']-0x1,_0x2d1cca['d']);return _0x892b4f===_0x5c18da(0x22f)?_0x2d1cca['toString']()[_0x5c18da(0x1f3)](_0x116a0e[_0x5c18da(0x1ef)]()):_0x116a0e[_0x5c18da(0x1ef)]()[_0x5c18da(0x1f3)](_0x2d1cca[_0x5c18da(0x1ef)]());}),_0x26d0f9(_0x3eed4a);}),$(_0x55a3b4(0x212))['on'](_0x55a3b4(0x1f9),function(){const _0x69d646=_0x55a3b4,_0x5d5624=$(this)[_0x69d646(0x1fb)]()[_0x69d646(0x201)]();$('#resultTable\x20tbody\x20tr')[_0x69d646(0x219)](function(){const _0x4a6ff7=_0x69d646;$(this)['toggle']($(this)[_0x4a6ff7(0x204)]()[_0x4a6ff7(0x201)]()[_0x4a6ff7(0x21a)](_0x5d5624)>-0x1);});}),$(_0x55a3b4(0x20d))['on'](_0x55a3b4(0x206),function(){const _0x4cc107=_0x55a3b4,_0x39c8ee=XLSX['utils'][_0x4cc107(0x1ea)](_0x3eed4a),_0x6f901d=XLSX[_0x4cc107(0x205)]['book_new']();XLSX[_0x4cc107(0x205)][_0x4cc107(0x227)](_0x6f901d,_0x39c8ee,_0x4cc107(0x211));const _0x2a9321=new Date(),_0x3377ed=_0x4cc107(0x1ec)+_0x2a9321['toLocaleDateString']()+_0x4cc107(0x1f6)+_0x2a9321[_0x4cc107(0x1ed)]();_0x39c8ee[_0x4cc107(0x1f2)]=[{'hpt':0x14}];const _0x1f2dcf=_0x39c8ee['!ref'][_0x4cc107(0x223)](':')[0x1][_0x4cc107(0x1fd)](/\D/g,''),_0x4e4fe2='A'+(parseInt(_0x1f2dcf)+0x1);_0x39c8ee[_0x4e4fe2]={'v':_0x3377ed,'t':'s'},_0x39c8ee[_0x4e4fe2]['s']={'alignment':{'horizontal':'right'},'font':{'bold':!![]}},XLSX['writeFile'](_0x6f901d,'البيانات\x20المفلترة.xlsx');});}));function _0x4f42(){const _0x4186cf=['19954500GxEYju','asc','parse_date_code','#resultTable\x20tbody','#loadingMessage','json_to_sheet','SSF','تاريخ\x20التصدير:\x20','toLocaleTimeString','3813762Mtrznn','toString','#filterModal','column','!rows','localeCompare','Center\x20Name','2336732ABQVIV','\x20|\x20الوقت:\x20','2591285FxgOxL','9171120EtVrYi','keyup','<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','val','#fileInput','replace','HOF\x20FullName','includes','يرجى\x20اختيار\x20معيار\x20واحد\x20على\x20الأقل\x20للفلترة.','toLowerCase','2699494ycRyCH','trim','text','utils','click','push','empty','</td>\x0a\x20\x20\x20\x20\x20\x20</tr>','submit','Member\x20ID','#openFilterBtn','#downloadBtn','append','forEach','sheet_to_json','البيانات\x20المفلترة','#searchInput','#filterForm','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<td>','ready','readAsArrayBuffer','show','1hizNql','filter','indexOf','target','sort','files','read','4GUzDTA','length','Member\x20Gender','change','split','Vulnerability','result','18rshVqQ','book_append_sheet','1761525ZMcrrW','some','hide','Relation\x20Type','#resultCount','padStart'];_0x4f42=function(){return _0x4186cf;};return _0x4f42();}
  </script>
</body>

</html>